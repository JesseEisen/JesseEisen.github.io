import{_ as n}from"./app.ee4e96c4.js";import{h as s,o as a,a as t,w as o,b as e,k as c}from"./vendor.5a394a79.js";const p=e("div",null,[e("p",null,"本篇为一个纯笔记，用户记录阅读 python 手册里面的相关内容，python 的手册中总能发现一些非常不错的技巧，这让在写 Python 程序的时候，更加纯粹。"),e("h2",{id:"dataclasses"},[e("a",{class:"header-anchor",href:"#dataclasses","aria-hidden":"true"},"#"),c(" DataClasses")]),e("p",null,[c("这个包主要是通过装饰器来为用户自定义的类自动增加一些特殊的函数，比如 "),e("code",null,"__init__"),c(" 或者 "),e("code",null,"__repr__"),c(" 等。这个库会让写类变得更加简单和可控。一些例子：")]),e("pre",{class:"language-python"},[e("code",{class:"language-python"},[e("span",{class:"token keyword"},"from"),c(" dataclasses "),e("span",{class:"token keyword"},"import"),c(" dataclass， field"),e("span",{class:"token punctuation"},","),c(" astuple"),e("span",{class:"token punctuation"},","),c(" asdict\n\n"),e("span",{class:"token decorator annotation punctuation"},"@dataclass"),e("span",{class:"token punctuation"},"("),c("order"),e("span",{class:"token operator"},"="),e("span",{class:"token boolean"},"True"),e("span",{class:"token punctuation"},")"),c("\n"),e("span",{class:"token keyword"},"class"),c(),e("span",{class:"token class-name"},"Person"),e("span",{class:"token punctuation"},":"),c("\n    name"),e("span",{class:"token punctuation"},":"),c(),e("span",{class:"token builtin"},"str"),c("\n    gender"),e("span",{class:"token punctuation"},":"),c(),e("span",{class:"token builtin"},"str"),c("\n    age"),e("span",{class:"token punctuation"},":"),c(),e("span",{class:"token builtin"},"int"),c("\n    sort_index"),e("span",{class:"token punctuation"},":"),c(),e("span",{class:"token builtin"},"int"),c(),e("span",{class:"token operator"},"="),c(" field"),e("span",{class:"token punctuation"},"("),c("init"),e("span",{class:"token operator"},"="),e("span",{class:"token boolean"},"False"),e("span",{class:"token punctuation"},","),c(),e("span",{class:"token builtin"},"repr"),e("span",{class:"token operator"},"="),e("span",{class:"token boolean"},"False"),e("span",{class:"token punctuation"},")"),c("\n\n    "),e("span",{class:"token keyword"},"def"),c(),e("span",{class:"token function"},"__post_init__"),e("span",{class:"token punctuation"},"("),c("self"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},":"),c("\n        self"),e("span",{class:"token punctuation"},"."),c("sort_index "),e("span",{class:"token operator"},"="),c(" self"),e("span",{class:"token punctuation"},"."),c("age\n\n"),e("span",{class:"token keyword"},"print"),e("span",{class:"token punctuation"},"("),e("span",{class:"token builtin"},"dir"),e("span",{class:"token punctuation"},"("),c("Person"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),c("\n\np1 "),e("span",{class:"token operator"},"="),c(" Person"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},'"a"'),e("span",{class:"token punctuation"},","),c(),e("span",{class:"token string"},'"z"'),e("span",{class:"token punctuation"},","),c(),e("span",{class:"token number"},"10"),e("span",{class:"token punctuation"},")"),c("\np2 "),e("span",{class:"token operator"},"="),c(" Person"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},'"b"'),e("span",{class:"token punctuation"},","),c(),e("span",{class:"token string"},'"m"'),e("span",{class:"token punctuation"},","),c(),e("span",{class:"token number"},"12"),e("span",{class:"token punctuation"},")"),c("\n\n"),e("span",{class:"token keyword"},"print"),e("span",{class:"token punctuation"},"("),c("p1"),e("span",{class:"token punctuation"},","),c(" p2"),e("span",{class:"token punctuation"},")"),c("\n"),e("span",{class:"token keyword"},"print"),e("span",{class:"token punctuation"},"("),c("astuple"),e("span",{class:"token punctuation"},"("),c("p1"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),c("\n"),e("span",{class:"token keyword"},"print"),e("span",{class:"token punctuation"},"("),c("asdict"),e("span",{class:"token punctuation"},"("),c("p2"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},")"),c("\n"),e("span",{class:"token keyword"},"if"),c(" p1 "),e("span",{class:"token operator"},"<"),c(" p2"),e("span",{class:"token punctuation"},":"),c("\n    "),e("span",{class:"token keyword"},"print"),e("span",{class:"token punctuation"},"("),e("span",{class:"token boolean"},"True"),e("span",{class:"token punctuation"},")"),c("\n")])]),e("p",null,"输出:"),e("pre",{class:"language-bash"},[e("code",{class:"language-bash"},[e("span",{class:"token punctuation"},"["),e("span",{class:"token string"},"'__annotations__'"),c(", "),e("span",{class:"token string"},"'__class__'"),c(", "),e("span",{class:"token string"},"'__dataclass_fields__'"),c(", "),e("span",{class:"token string"},"'__dataclass_params__'"),c(", "),e("span",{class:"token string"},"'__delattr__'"),c(", "),e("span",{class:"token string"},"'__dict__'"),c(", "),e("span",{class:"token string"},"'__dir__'"),c(", "),e("span",{class:"token string"},"'__doc__'"),c(", "),e("span",{class:"token string"},"'__eq__'"),c(", "),e("span",{class:"token string"},"'__format__'"),c(", "),e("span",{class:"token string"},"'__ge__'"),c(", "),e("span",{class:"token string"},"'__getattribute__'"),c(", "),e("span",{class:"token string"},"'__gt__'"),c(", "),e("span",{class:"token string"},"'__hash__'"),c(", "),e("span",{class:"token string"},"'__init__'"),c(", "),e("span",{class:"token string"},"'__init_subclass__'"),c(", "),e("span",{class:"token string"},"'__le__'"),c(", "),e("span",{class:"token string"},"'__lt__'"),c(", "),e("span",{class:"token string"},"'__module__'"),c(", "),e("span",{class:"token string"},"'__ne__'"),c(", "),e("span",{class:"token string"},"'__new__'"),c(", "),e("span",{class:"token string"},"'__post_init__'"),c(", "),e("span",{class:"token string"},"'__reduce__'"),c(", "),e("span",{class:"token string"},"'__reduce_ex__'"),c(", "),e("span",{class:"token string"},"'__repr__'"),c(", "),e("span",{class:"token string"},"'__setattr__'"),c(", "),e("span",{class:"token string"},"'__sizeof__'"),c(", "),e("span",{class:"token string"},"'__str__'"),c(", "),e("span",{class:"token string"},"'__subclasshook__'"),c(", "),e("span",{class:"token string"},"'__weakref__'"),e("span",{class:"token punctuation"},"]"),c("\nPerson"),e("span",{class:"token punctuation"},"("),c("name"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},"'a'"),c(", "),e("span",{class:"token assign-left variable"},"gender"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},"'z'"),c(", "),e("span",{class:"token assign-left variable"},"age"),e("span",{class:"token operator"},"="),e("span",{class:"token number"},"10"),e("span",{class:"token punctuation"},")"),c(" Person"),e("span",{class:"token punctuation"},"("),c("name"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},"'b'"),c(", "),e("span",{class:"token assign-left variable"},"gender"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},"'m'"),c(", "),e("span",{class:"token assign-left variable"},"age"),e("span",{class:"token operator"},"="),e("span",{class:"token number"},"12"),e("span",{class:"token punctuation"},")"),c("\n"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'a'"),c(", "),e("span",{class:"token string"},"'z'"),c(", "),e("span",{class:"token number"},"10"),c(", "),e("span",{class:"token number"},"10"),e("span",{class:"token punctuation"},")"),c("\n"),e("span",{class:"token punctuation"},"{"),e("span",{class:"token string"},"'name'"),e("span",{class:"token builtin class-name"},":"),c(),e("span",{class:"token string"},"'b'"),c(", "),e("span",{class:"token string"},"'gender'"),e("span",{class:"token builtin class-name"},":"),c(),e("span",{class:"token string"},"'m'"),c(", "),e("span",{class:"token string"},"'age'"),e("span",{class:"token builtin class-name"},":"),c(),e("span",{class:"token number"},"12"),c(", "),e("span",{class:"token string"},"'sort_index'"),e("span",{class:"token builtin class-name"},":"),c(),e("span",{class:"token number"},"12"),e("span",{class:"token punctuation"},"}"),c("\nTrue\n")])]),e("p",null,[c("上面例子中展示了大部分的 dataclass 的功能。 在定义类的时候，可以通过 "),e("code",null,"order=True"),c(" 来让类的属性按照添加的顺序排序。这边的依据是添加了 "),e("code",null,"field"),c(" 的 sort_index 字段，这个字段不需要在创建实例的时候被初始化，也不会出现在 "),e("code",null,"__repr__"),c("· 方法中。 使用 "),e("code",null,"__post__init__"),c(" 钩子函数为这个 sort_index 字段赋值。所以在后面的比较中，只会根据 age 的大小来比较大小。")]),e("p",null,[c("还有两个比较方便的函数 "),e("code",null,"astuple"),c(" 和 "),e("code",null,"asdict"),c("，它们的作用是将一个实例转换成元组和字典。")]),e("p",null,[c("注意上面的例子中，我们是无法在外部访问到 "),e("code",null,"sort_index"),c(" 字段的。因为它没有被初始化在 "),e("code",null,"__init__"),c(" 中。 此外，可以在 "),e("code",null,"dataclass"),c(" 的装饰器内使用 "),e("code",null,"frozen=True"),c(" 参数来让类的属性都变成只读的。")]),e("p",null,"另外还有一个比较有意思的设置 keyword 的方式，如下一个例子："),e("pre",{class:"language-python"},[e("code",{class:"language-python"},[e("span",{class:"token decorator annotation punctuation"},"@dataclass"),c("\n"),e("span",{class:"token keyword"},"class"),c(),e("span",{class:"token class-name"},"Point"),e("span",{class:"token punctuation"},":"),c("\n    x"),e("span",{class:"token punctuation"},":"),c(),e("span",{class:"token builtin"},"int"),c("\n    _"),e("span",{class:"token punctuation"},":"),c(" KW_ONLY\n    y"),e("span",{class:"token punctuation"},":"),c(),e("span",{class:"token builtin"},"int"),c("\n    z"),e("span",{class:"token punctuation"},":"),c(),e("span",{class:"token builtin"},"float"),c("\n\np "),e("span",{class:"token operator"},"="),c(" Point"),e("span",{class:"token punctuation"},"("),e("span",{class:"token number"},"1"),e("span",{class:"token punctuation"},","),c("y"),e("span",{class:"token operator"},"="),e("span",{class:"token number"},"2"),e("span",{class:"token punctuation"},","),c("z"),e("span",{class:"token operator"},"="),e("span",{class:"token number"},"3.0"),e("span",{class:"token punctuation"},")"),c("\n")])]),e("p",null,[c("在 "),e("code",null,"KW_ONLY"),c(" 之后的字段会被认为是关键字参数, 该 feature "),e("strong",null,"需要 Python 版本是 3.10"),c(" 以上。")]),e("ul",null,[e("li",null,[e("a",{href:"https://docs.python.org/3/library/dataclasses.html",target:"_blank",rel:"noopener"},"DataClasses 官方文档")]),e("li",null,[e("a",{href:"https://towardsdatascience.com/9-reasons-why-you-should-start-using-python-dataclasses-98271adadc66",target:"_blank",rel:"noopener"},"9 Reasons why You Should start using python dataclasses")])]),e("h2",{id:"datetime"},[e("a",{class:"header-anchor",href:"#datetime","aria-hidden":"true"},"#"),c(" datetime")]),e("p",null,[c("使用 "),e("code",null,"strptime"),c(" 时， %f 的默认行为是在右侧补0, 这个是 c 标准中的扩展 feature。一般在解析带有毫秒的情况时，需要注意"),e("strong",null,"右侧补零"),c("的操作。")]),e("pre",{class:"language-python"},[e("code",{class:"language-python"},[e("span",{class:"token operator"},">>"),e("span",{class:"token operator"},">"),c(" a "),e("span",{class:"token operator"},"="),c(" datetime"),e("span",{class:"token punctuation"},"."),c("strptime"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'2022-01-02 22:01:15,6'"),e("span",{class:"token punctuation"},","),c(),e("span",{class:"token string"},"'%Y-%m-%d %H:%M:%S,%f'"),e("span",{class:"token punctuation"},")"),c("\n"),e("span",{class:"token operator"},">>"),e("span",{class:"token operator"},">"),c(" a"),e("span",{class:"token punctuation"},"."),c("microsecond\n"),e("span",{class:"token number"},"600000"),c("\n"),e("span",{class:"token operator"},">>"),e("span",{class:"token operator"},">"),c(),e("span",{class:"token keyword"},"for"),c(" it "),e("span",{class:"token keyword"},"in"),c(" a"),e("span",{class:"token punctuation"},"."),c("timetuple"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},":"),c("\n"),e("span",{class:"token punctuation"},"."),e("span",{class:"token punctuation"},"."),e("span",{class:"token punctuation"},"."),c("     "),e("span",{class:"token keyword"},"print"),e("span",{class:"token punctuation"},"("),c("it"),e("span",{class:"token punctuation"},")"),c("\n"),e("span",{class:"token punctuation"},"."),e("span",{class:"token punctuation"},"."),e("span",{class:"token punctuation"},"."),c(" \n"),e("span",{class:"token number"},"2022"),c("   "),e("span",{class:"token comment"},"# year"),c("\n"),e("span",{class:"token number"},"1"),c("      "),e("span",{class:"token comment"},"# month"),c("\n"),e("span",{class:"token number"},"2"),c("      "),e("span",{class:"token comment"},"# day"),c("\n"),e("span",{class:"token number"},"22"),c("     "),e("span",{class:"token comment"},"# hour"),c("\n"),e("span",{class:"token number"},"1"),c("      "),e("span",{class:"token comment"},"# minute"),c("\n"),e("span",{class:"token number"},"15"),c("     "),e("span",{class:"token comment"},"# second"),c("\n"),e("span",{class:"token number"},"6"),c("      "),e("span",{class:"token comment"},"# weekday (0 = Monday)"),c("\n"),e("span",{class:"token number"},"2"),c("      "),e("span",{class:"token comment"},"# number of days since 1st January"),c("\n"),e("span",{class:"token operator"},"-"),e("span",{class:"token number"},"1"),c("     "),e("span",{class:"token comment"},"# dst - method tzinfo.dst() returned None"),c("\n")])])],-1),l={expose:[],setup(e){const c={title:"Python Documentation Read",date:"2021-12-01T00:00:00.000Z",author:"Linkang Chan",twitter:"JessEisen_LJ",description:"python documentation read record",public:!0,tag:"21X13 pydoc",meta:[{property:"og:title",content:"Python Documentation Read"},{property:"og:description",content:"python documentation read record"},{name:"description",content:"python documentation read record"}]};return s({title:"Python Documentation Read",meta:[{property:"og:title",content:"Python Documentation Read"},{property:"og:description",content:"python documentation read record"},{name:"description",content:"python documentation read record"}]}),(s,e)=>{const l=n;return a(),t(l,{frontmatter:c},{default:o((()=>[p])),_:1})}}};export default l;
