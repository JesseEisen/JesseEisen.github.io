import{_ as n}from"./LinkItem.65bc6d8d.js";import{_ as t}from"./app.449ba84e.js";import{h as s,o as a,a as e,w as o,b as c,k as p}from"./vendor.80607e96.js";const i=c("h2",{id:"http-header-相关"},[c("a",{class:"header-anchor",href:"#http-header-相关","aria-hidden":"true"},"#"),p(" HTTP Header 相关")],-1),u=c("p",null,"MDN 上的一些基础概念介绍：",-1),l=p(" Request HTTP Header "),r=p(" Response HTTP Header "),k=c("p",null,[p("一篇"),c("a",{href:"https://blog.csdn.net/tianmohust/article/details/8840256",target:"_blank",rel:"noopener"},"博文"),p("详细说明了上述的两个 header 标记。 在 Go 中可以有如下的实现，下方代码是 "),c("code",null,"net/http"),p(" 中的实现：")],-1),d=c("pre",{class:"language-go"},[c("code",{class:"language-go"},[c("span",{class:"token comment"},"// modtime is the modification time of the resource to be served, or IsZero()."),p("\n"),c("span",{class:"token comment"},"// return value is whether this request is now complete."),p("\n"),c("span",{class:"token keyword"},"func"),p(),c("span",{class:"token function"},"checkLastModified"),c("span",{class:"token punctuation"},"("),p("w http"),c("span",{class:"token punctuation"},"."),p("ResponseWriter"),c("span",{class:"token punctuation"},","),p(" r "),c("span",{class:"token operator"},"*"),p("http"),c("span",{class:"token punctuation"},"."),p("Request"),c("span",{class:"token punctuation"},","),p(" modtime time"),c("span",{class:"token punctuation"},"."),p("Time"),c("span",{class:"token punctuation"},")"),p(),c("span",{class:"token builtin"},"bool"),p(),c("span",{class:"token punctuation"},"{"),p("\n\t"),c("span",{class:"token keyword"},"if"),p(" modtime"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"IsZero"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),p(),c("span",{class:"token operator"},"||"),p(" modtime"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Equal"),c("span",{class:"token punctuation"},"("),p("unixEpochTime"),c("span",{class:"token punctuation"},")"),p(),c("span",{class:"token punctuation"},"{"),p("\n\t\t"),c("span",{class:"token comment"},"// If the file doesn't have a modtime (IsZero), or the modtime"),p("\n\t\t"),c("span",{class:"token comment"},"// is obviously garbage (Unix time == 0), then ignore modtimes"),p("\n\t\t"),c("span",{class:"token comment"},"// and don't process the If-Modified-Since header."),p("\n\t\t"),c("span",{class:"token keyword"},"return"),p(),c("span",{class:"token boolean"},"false"),p("\n\t"),c("span",{class:"token punctuation"},"}"),p("\n\n\t"),c("span",{class:"token comment"},"// The Date-Modified header truncates sub-second precision, so"),p("\n\t"),c("span",{class:"token comment"},"// use mtime < t+1s instead of mtime <= t to check for unmodified."),p("\n\t"),c("span",{class:"token keyword"},"if"),p(" t"),c("span",{class:"token punctuation"},","),p(" err "),c("span",{class:"token operator"},":="),p(" time"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Parse"),c("span",{class:"token punctuation"},"("),p("http"),c("span",{class:"token punctuation"},"."),p("TimeFormat"),c("span",{class:"token punctuation"},","),p(" r"),c("span",{class:"token punctuation"},"."),p("Header"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Get"),c("span",{class:"token punctuation"},"("),c("span",{class:"token string"},'"If-Modified-Since"'),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),p(" err "),c("span",{class:"token operator"},"=="),p(),c("span",{class:"token boolean"},"nil"),p(),c("span",{class:"token operator"},"&&"),p(" modtime"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Before"),c("span",{class:"token punctuation"},"("),p("t"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Add"),c("span",{class:"token punctuation"},"("),c("span",{class:"token number"},"1"),c("span",{class:"token operator"},"*"),p("time"),c("span",{class:"token punctuation"},"."),p("Second"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},")"),p(),c("span",{class:"token punctuation"},"{"),p("\n\t\th "),c("span",{class:"token operator"},":="),p(" w"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Header"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),p("\n\t\t"),c("span",{class:"token function"},"delete"),c("span",{class:"token punctuation"},"("),p("h"),c("span",{class:"token punctuation"},","),p(),c("span",{class:"token string"},'"Content-Type"'),c("span",{class:"token punctuation"},")"),p("\n\t\t"),c("span",{class:"token function"},"delete"),c("span",{class:"token punctuation"},"("),p("h"),c("span",{class:"token punctuation"},","),p(),c("span",{class:"token string"},'"Content-Length"'),c("span",{class:"token punctuation"},")"),p("\n\t\tw"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"WriteHeader"),c("span",{class:"token punctuation"},"("),p("http"),c("span",{class:"token punctuation"},"."),p("StatusNotModified"),c("span",{class:"token punctuation"},")"),p("\n\t\t"),c("span",{class:"token keyword"},"return"),p(),c("span",{class:"token boolean"},"true"),p("\n\t"),c("span",{class:"token punctuation"},"}"),p("\n\tw"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Header"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Set"),c("span",{class:"token punctuation"},"("),c("span",{class:"token string"},'"Last-Modified"'),c("span",{class:"token punctuation"},","),p(" modtime"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"UTC"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"Format"),c("span",{class:"token punctuation"},"("),p("http"),c("span",{class:"token punctuation"},"."),p("TimeFormat"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},")"),p("\n\t"),c("span",{class:"token keyword"},"return"),p(),c("span",{class:"token boolean"},"false"),p("\n"),c("span",{class:"token punctuation"},"}"),p("\n")])],-1),m=c("h2",{id:"docker-相关"},[c("a",{class:"header-anchor",href:"#docker-相关","aria-hidden":"true"},"#"),p(" Docker 相关")],-1),f=p(" 500 行 C 代码实现 linux 容器"),h={expose:[],setup(p){const h={title:"TIL-22F07",date:"2022-03-18T00:00:00.000Z",author:"Linkang Chan",twitter:"JessEisen_LJ",description:"TIL",public:!0,tag:"22F07 2022-03-18",meta:[{property:"og:title",content:"TIL-22F07"},{property:"og:description",content:"TIL"},{name:"description",content:"TIL"}]};return s({title:"TIL-22F07",meta:[{property:"og:title",content:"TIL-22F07"},{property:"og:description",content:"TIL"},{name:"description",content:"TIL"}]}),(s,p)=>{const T=n,g=t;return a(),e(g,{frontmatter:h},{default:o((()=>[c("div",null,[i,u,c("p",null,[c(T,{text:"If-Modified-Since",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/If-Modified-Since"},{default:o((()=>[l])),_:1}),c(T,{text:"Last-Modified",url:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Last-Modified"},{default:o((()=>[r])),_:1})]),k,d,m,c("p",null,[c(T,{text:"linux-containers-in-500",url:"https://blog.lizzie.io/linux-containers-in-500-loc.html"},{default:o((()=>[f])),_:1})])])])),_:1})}}};export default h;
