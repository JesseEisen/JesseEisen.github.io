import{_ as n}from"./app.7a11c0f4.js";import{h as s,o as a,a as e,w as o,b as t,k as p}from"./vendor.57ddf3fb.js";const l=t("div",null,[t("p",null,"postgresql 是一款开源的对象关系数据库管理系统。pg 可以说是一款全栈的数据库，毕竟 slogan 是 “世界上最先进的关系型数据库”。同时 pg 比 mysql 少不少的坑，使用上会舒心一些。 本文主要是记录 pg 的使用方式，同时也会记录一些 sql 的语句或者 pg 独有的一些操作。"),t("h3",{id:"ⅰ-创建用户"},[t("a",{class:"header-anchor",href:"#ⅰ-创建用户","aria-hidden":"true"},"#"),p(" Ⅰ 创建用户")]),t("p",null,[p("pg 安装后默认会有一个 "),t("code",null,"postgres"),p(" 的用户，要创建新用户，需要先切换到该账户，然后执行如下的操作。")]),t("pre",{class:"language-sql"},[t("code",{class:"language-sql"},[p("$ su "),t("span",{class:"token operator"},"-"),p(" postgres\n"),t("span",{class:"token operator"},"-"),p("bash"),t("span",{class:"token operator"},"-"),t("span",{class:"token number"},"4.2"),p("$ psql\npostgre"),t("span",{class:"token operator"},"="),t("span",{class:"token comment"},"# create user username with password 'xxxxx';"),p("\npostgre"),t("span",{class:"token operator"},"="),t("span",{class:"token comment"},"# create database databaseName owner username;"),p("\npostgre"),t("span",{class:"token operator"},"="),t("span",{class:"token comment"},"# grant all privileges on database databaseName to username;"),p("\n")])]),t("h3",{id:"ⅱ-登录数据库"},[t("a",{class:"header-anchor",href:"#ⅱ-登录数据库","aria-hidden":"true"},"#"),p(" Ⅱ 登录数据库")]),t("p",null,"使用用户名密码登录："),t("pre",{class:"language-sql"},[t("code",{class:"language-sql"},[p("$ psql "),t("span",{class:"token operator"},"-"),p("h hosturl "),t("span",{class:"token operator"},"-"),p("U username "),t("span",{class:"token operator"},"-"),p("d databasename "),t("span",{class:"token operator"},"-"),p("p port\n")])]),t("p",null,[t("strong",null,"注意"),p(" 在一些编程的库中使用上面的方式可能会报 "),t("code",null,"sslmode required not support"),p(" 。通过增加 "),t("code",null,"sslmode=disable"),p(" 可以解决。")]),t("h3",{id:"ⅲ-导入导出"},[t("a",{class:"header-anchor",href:"#ⅲ-导入导出","aria-hidden":"true"},"#"),p(" Ⅲ 导入导出")]),t("p",null,"可以通过一些外部命令将 pg 数据库中的内容导出到一个 sql 文件中，同时也可以将这个 sql 文件重新应用到另外的数据库中。操作如下："),t("pre",{class:"language-sql"},[t("code",{class:"language-sql"},[t("span",{class:"token comment"},"# export to dump.sql"),p("\n$ pg_dump "),t("span",{class:"token operator"},"-"),p("h hosturl "),t("span",{class:"token operator"},"-"),p("U username databasename "),t("span",{class:"token operator"},">"),p(),t("span",{class:"token operator"},"/"),p("path"),t("span",{class:"token operator"},"/"),p("tp"),t("span",{class:"token operator"},"/"),t("span",{class:"token keyword"},"save"),t("span",{class:"token operator"},"/"),t("span",{class:"token keyword"},"dump"),t("span",{class:"token punctuation"},"."),t("span",{class:"token keyword"},"sql"),p("\n\n"),t("span",{class:"token comment"},"# import to new database "),p("\n$ psql "),t("span",{class:"token operator"},"-"),p("h hosturl "),t("span",{class:"token operator"},"-"),p("d "),t("span",{class:"token keyword"},"database"),p(),t("span",{class:"token operator"},"-"),p("U username "),t("span",{class:"token operator"},"-"),p("f "),t("span",{class:"token keyword"},"dump"),t("span",{class:"token punctuation"},"."),t("span",{class:"token keyword"},"sql"),p("\n")])]),t("h3",{id:"ⅳ-插入数据"},[t("a",{class:"header-anchor",href:"#ⅳ-插入数据","aria-hidden":"true"},"#"),p(" Ⅳ 插入数据")]),t("p",null,"values 可以指定多个，批量插入。"),t("pre",{class:"language-sql"},[t("code",{class:"language-sql"},[t("span",{class:"token keyword"},"insert"),p(),t("span",{class:"token keyword"},"into"),p(" table_name "),t("span",{class:"token punctuation"},"("),p("column1"),t("span",{class:"token punctuation"},","),p(" column2"),t("span",{class:"token punctuation"},","),p(" column3"),t("span",{class:"token punctuation"},")"),p(),t("span",{class:"token keyword"},"values"),p(),t("span",{class:"token punctuation"},"("),p("value1"),t("span",{class:"token punctuation"},","),p(" value2"),t("span",{class:"token punctuation"},","),p(" value3"),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"["),t("span",{class:"token punctuation"},","),t("span",{class:"token punctuation"},"("),t("span",{class:"token punctuation"},","),t("span",{class:"token punctuation"},"."),t("span",{class:"token punctuation"},"."),t("span",{class:"token punctuation"},"."),t("span",{class:"token punctuation"},")"),t("span",{class:"token punctuation"},"]"),t("span",{class:"token punctuation"},";"),p("\n")])]),t("h3",{id:"ⅴ-更新数据"},[t("a",{class:"header-anchor",href:"#ⅴ-更新数据","aria-hidden":"true"},"#"),p(" Ⅴ 更新数据")]),t("pre",{class:"language-sql"},[t("code",{class:"language-sql"},[t("span",{class:"token keyword"},"UPDATE"),p(" table_name\n"),t("span",{class:"token keyword"},"SET"),p(" column1 "),t("span",{class:"token operator"},"="),p(" value1"),t("span",{class:"token punctuation"},","),p(" column2 "),t("span",{class:"token operator"},"="),p(" value2"),t("span",{class:"token punctuation"},"."),t("span",{class:"token punctuation"},"."),t("span",{class:"token punctuation"},"."),t("span",{class:"token punctuation"},"."),t("span",{class:"token punctuation"},","),p(" columnN "),t("span",{class:"token operator"},"="),p(" valueN\n"),t("span",{class:"token keyword"},"WHERE"),p(),t("span",{class:"token punctuation"},"["),p("condition"),t("span",{class:"token punctuation"},"]"),t("span",{class:"token punctuation"},";"),p("\n"),t("span",{class:"token keyword"},"RETURNING"),p(),t("span",{class:"token operator"},"*"),p(),t("span",{class:"token operator"},"|"),p(" output_expression "),t("span",{class:"token keyword"},"AS"),p(" output_name"),t("span",{class:"token punctuation"},";"),p("\n")])]),t("p",null,[t("code",null,"RETURNING"),p(" 表示返回更新后符合条件的记录")]),t("h3",{id:"ⅵ-修改表格字段"},[t("a",{class:"header-anchor",href:"#ⅵ-修改表格字段","aria-hidden":"true"},"#"),p(" Ⅵ 修改表格字段")]),t("pre",{class:"language-sql"},[t("code",{class:"language-sql"},[t("span",{class:"token comment"},"# 增加字段"),p("\n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"TABLE"),p(" table_name \n"),t("span",{class:"token keyword"},"ADD"),p(),t("span",{class:"token keyword"},"COLUMN"),p(" column_name datatype column_constraint"),t("span",{class:"token punctuation"},";"),p("\n\n"),t("span",{class:"token comment"},"# 删除字段"),p("\n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"TABLE"),p(" table_name \n"),t("span",{class:"token keyword"},"DROP"),p(),t("span",{class:"token keyword"},"COLUMN"),p(" column_name"),t("span",{class:"token punctuation"},";"),p("\n\n"),t("span",{class:"token comment"},"# 重命名字段"),p("\n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"TABLE"),p(" table_name \n"),t("span",{class:"token keyword"},"RENAME"),p(),t("span",{class:"token keyword"},"COLUMN"),p(" column_name \n"),t("span",{class:"token keyword"},"TO"),p(" new_column_name"),t("span",{class:"token punctuation"},";"),p("\n\n"),t("span",{class:"token comment"},"# 改变默认值"),p("\n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"TABLE"),p(" table_name \n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"COLUMN"),p(" column_name \n"),t("span",{class:"token punctuation"},"["),t("span",{class:"token keyword"},"SET"),p(),t("span",{class:"token keyword"},"DEFAULT"),p(),t("span",{class:"token keyword"},"value"),p(),t("span",{class:"token operator"},"|"),p(),t("span",{class:"token keyword"},"DROP"),p(),t("span",{class:"token keyword"},"DEFAULT"),t("span",{class:"token punctuation"},"]"),t("span",{class:"token punctuation"},";"),p("\n\n"),t("span",{class:"token comment"},"# 修改 not null 限制"),p("\n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"TABLE"),p(" table_name \n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"COLUMN"),p(" column_name \n"),t("span",{class:"token punctuation"},"["),t("span",{class:"token keyword"},"SET"),p(),t("span",{class:"token operator"},"NOT"),p(),t("span",{class:"token boolean"},"NULL"),t("span",{class:"token operator"},"|"),p(),t("span",{class:"token keyword"},"DROP"),p(),t("span",{class:"token operator"},"NOT"),p(),t("span",{class:"token boolean"},"NULL"),t("span",{class:"token punctuation"},"]"),t("span",{class:"token punctuation"},";"),p("\n\n"),t("span",{class:"token comment"},"# 增加check限制"),p("\n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"TABLE"),p(" table_name \n"),t("span",{class:"token keyword"},"ADD"),p(),t("span",{class:"token keyword"},"CONSTRAINT"),p(" constraint_name constraint_definition"),t("span",{class:"token punctuation"},";"),p("\n\n"),t("span",{class:"token comment"},"# 增加其他限制"),p("\n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"TABLE"),p(" table_name \n"),t("span",{class:"token keyword"},"ADD"),p(),t("span",{class:"token keyword"},"CONSTRAINT"),p(" constraint_name constraint_definition"),t("span",{class:"token punctuation"},";"),p("\n\n"),t("span",{class:"token comment"},"# 重命名表"),p("\n"),t("span",{class:"token keyword"},"ALTER"),p(),t("span",{class:"token keyword"},"TABLE"),p(" table_name \n"),t("span",{class:"token keyword"},"RENAME"),p(),t("span",{class:"token keyword"},"TO"),p(" new_table_name"),t("span",{class:"token punctuation"},";"),p("\n")])])],-1),c={expose:[],setup(t){const p={title:"PostgreSQL In Action",date:"2021-01-25T00:00:00.000Z",author:"Linkang Chan",twitter:"JessEisen_LJ",description:"postgresql",public:!0,tag:"21B12 postgresql",meta:[{property:"og:title",content:"PostgreSQL In Action"},{property:"og:description",content:"postgresql"},{name:"description",content:"postgresql"}]};return s({title:"PostgreSQL In Action",meta:[{property:"og:title",content:"PostgreSQL In Action"},{property:"og:description",content:"postgresql"},{name:"description",content:"postgresql"}]}),(s,t)=>{const c=n;return a(),e(c,{frontmatter:p},{default:o((()=>[l])),_:1})}}};export default c;
