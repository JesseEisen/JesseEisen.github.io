<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="referrer" content="no-referrer"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/pwa-192x192.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9"><meta name="msapplication-TileColor" content="#00aba9"><meta name="theme-color" content="#ffffff"><script type="module" async="" crossorigin="" src="/assets/app.449ba84e.js"></script><link rel="modulepreload" href="/assets/vendor.80607e96.js"><link rel="stylesheet" href="/assets/app.288c200a.css"><link rel="manifest" href="/manifest.webmanifest"><link rel="modulepreload" crossorigin="" href="/assets/jsbase.c3072be6.js"><link rel="modulepreload" crossorigin="" href="/assets/Code.fee8bdde.js"><link rel="stylesheet" href="/assets/Code.1ebb05a2.css"><link rel="modulepreload" crossorigin="" href="/assets/LinkItem.65bc6d8d.js"><link rel="stylesheet" href="/assets/LinkItem.bf447482.css"><meta property="og:title" content="Javascript INFO notes"><meta property="og:description" content="morden javascript"><meta name="description" content="morden javascript"><meta name="head:count" content="3"><title>Chan93</title></head><body><div id="app" data-server-rendered="true"><div h="full" flex="~ col" p="x-4"><nav z="100" text="dark-100 dark:light-900" position="fixed top-0 left-0 right-0" bg="dark:dark-500 dark:opacity-50 white opacity-75" backdrop="~ blur-lg" h="18" p="x-4" border="b-1 dark:dark-500"><div max-w="screen-lg" m="ml-4" h="full" flex="~ row" items="center" space="x-4"><a href="/" class="" flex="1"><h1 text="2xl" font="bold">🐣 WhatIf</h1></a><a href="/blogs" class=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 16c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2M6 16c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m12 12c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2z" fill="currentColor"></path></svg></a><a href="/notes" class=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M14.6 16.6l4.6-4.6l-4.6-4.6L16 6l6 6l-6 6l-1.4-1.4m-5.2 0L4.8 12l4.6-4.6L8 6l-6 6l6 6l1.4-1.4z" fill="currentColor"></path></svg></a><a href="/books" class=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2l4 13l3-1l-4-13l-3 1M5 5v13h3V5H5M3 19v2h18v-2H3z" fill="currentColor"></path></svg></a><a href="/daily" class=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5z" fill="currentColor"></path></svg></a><a href="https://github.com/jesseeisen" target="_blank" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33c.85 0 1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z" fill="currentColor"></path></svg></a><a cursor="pointer"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg></a></div></nav><main flex="~ 1 row" justify="start" w="full" max-w="screen-lg" m="ml-4" p="t-18" text="dark:light-400 dark-300"><div data-v-610c0928=""><div data-v-610c0928=""><a flex="~ row" items="center" class="dark:text-white-900 dark:opacity-60" space="x-2" m="t-4" cursor="pointer" data-v-610c0928=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" text="12px" data-v-610c0928=""><path d="M14 26l1.41-1.41L7.83 17H28v-2H7.83l7.58-7.59L14 6L4 16l10 10z" fill="currentColor"></path></svg><span text="12px dark:light-50 true-gray-500" font="bold" data-v-610c0928="">Back to prev</span></a></div><header text="center" border="b-1 dark:dark-200" p="y-10" data-v-610c0928=""><h1 text="36px dark:light-50 dark " font=" extrabold -.015em 48px" class="post-title" data-v-610c0928="">Javascript INFO notes</h1><div my="20px" data-v-610c0928=""><span text="sm dark:light-900 dark:opacity-60 #666" m="b-2" display="block" data-v-610c0928="">Jan 5, 2022</span></div><div text="left" flex="~" m="t-4" data-v-610c0928=""><div flex="~ row" items="center" space="x-2" class="mx-auto" data-v-610c0928="" data-v-22abfd34=""><img border="rounded-full" src="https://secure.gravatar.com/avatar/190aa3adff4e1451b32c354f0b5fd7f9?size=30" data-v-22abfd34=""><div flex="~ col" class="author-info" data-v-22abfd34=""><span text="500 dark:light-900 dark:opacity-80 dark-900" data-v-22abfd34="">Linkang Chan</span><br data-v-22abfd34=""><a href="https://twitter.com/JessEisen_LJ" class="text-pink-500 text-sm" target="_blank" data-v-22abfd34="">@Jesse Chan</a></div></div></div></header><div flex="~" w="60%" justify="start" data-v-610c0928=""><article m="t-8" data-v-610c0928=""><div w="90%" class="prose prose-lg" text="dark:light-900 dark:opacity-72" data-v-610c0928=""><!--[--><div><p>本文记录现代 Javascript 的一些学习笔记，从头到尾的全面学习下 javascript。 从文档上看，这个教程的质量和细节部分还是挺多的。记录的内容大多是我没有接触过，或者比较模糊的部分。</p><h3 id="空值合并运算符"><a class="header-anchor" href="#空值合并运算符" aria-hidden="true">#</a>空值合并运算符</h3><p><code class="green" data-v-46b747e9=""><!--[-->??<!--]--></code>是用于在值为<code>null/undefined</code>这两个情况下返回第一个已经定义的值。 这个比<code class="green" data-v-46b747e9=""><!--[-->||<!--]--></code>行为不同的是：它对<code>0/""</code>等这些情况会认为是已定义的。<code>??</code>的优先级非常低，需要注意使用括号。</p><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token keyword">let</span> firstName <span class="token operator">=</span> <span class="token keyword">null</span>
<span class="token keyword">undefined</span>
<span class="token operator">&gt;</span> <span class="token keyword">let</span> secondname <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">undefined</span>
<span class="token operator">&gt;</span> <span class="token keyword">let</span> c <span class="token operator">=</span> secondname <span class="token operator">??</span> <span class="token string">'me?'</span>
<span class="token keyword">undefined</span>
<span class="token operator">&gt;</span> c
<span class="token string">''</span>
<span class="token operator">&gt;</span> <span class="token keyword">let</span> d <span class="token operator">=</span> firstName <span class="token operator">??</span> <span class="token string">'me!'</span>
<span class="token keyword">undefined</span>
<span class="token operator">&gt;</span> d
<span class="token string">'me!'</span>
<span class="token operator">&gt;</span>
</code></pre><p>同时可以通过多个串起来使用：</p><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token keyword">let</span> d <span class="token operator">=</span> firstName <span class="token operator">??</span> <span class="token string">'me!'</span>
<span class="token keyword">undefined</span>
<span class="token operator">&gt;</span> d
<span class="token string">'me!'</span>
<span class="token operator">&gt;</span> <span class="token keyword">let</span> e<span class="token operator">=</span><span class="token keyword">null</span>
<span class="token keyword">undefined</span>
<span class="token operator">&gt;</span> <span class="token keyword">let</span> g <span class="token operator">=</span> e <span class="token operator">??</span> firstName <span class="token operator">??</span> secondname <span class="token operator">??</span> d
<span class="token keyword">undefined</span>
<span class="token operator">&gt;</span> g
<span class="token string">''</span>
<span class="token operator">&gt;</span>
</code></pre><p>这边就会返回<code>secondname</code>这个非空的值。</p><h3 id="函数"><a class="header-anchor" href="#函数" aria-hidden="true">#</a>函数</h3><ul><li>不要在<code>return</code>与返回值之间添加新行，这会导致 return 变成单行指令，返回空置；</li></ul><pre class="language-js"><code class="language-js"><span class="token comment">// bad case</span>
<span class="token keyword">return</span>   <span class="token comment">// will be treat as return;</span>
  <span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span>

<span class="token comment">// optimized</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span>
    a <span class="token operator">+</span> b
<span class="token punctuation">)</span>
</code></pre><ul><li>函数表达式后尽量增加一个<code>;</code></li></ul><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><p>函数表达式是在代码执行到达时被创建，并且仅从那一刻起可用。</p><h3 id="代码质量"><a class="header-anchor" href="#代码质量" aria-hidden="true">#</a>代码质量</h3><ul><li><code>debugger;</code>单独的语句会让调试器在此暂停住，并且不会执行下一条语句。</li><li>当处于调试模式时，在代码中的某一行上右键，在显示的关联菜单（context menu）中点击一个非常有用的名为 “Continue to here” 的选项。</li></ul><p></p><div class="list-item" data-v-6caa15cd=""><span data-v-6caa15cd="">[<span data-v-6caa15cd=""><img style="display:inline-block;margin-right:2px;margin-top:1px;margin-bottom:2px" src="https://api.iconify.design/mdi:link-variant.svg" data-v-6caa15cd=""></span><a class="item-show" href="https://developer.chrome.com/docs/devtools/" target="_blank" data-v-6caa15cd="">devTool doc</a>]:<!--[--> Chrome dev tool 的相关文档<!--]--></span></div><p></p><h3 id="文档注释"><a class="header-anchor" href="#文档注释" aria-hidden="true">#</a>文档注释</h3><p></p><div class="list-item" data-v-6caa15cd=""><span data-v-6caa15cd="">[<span data-v-6caa15cd=""><img style="display:inline-block;margin-right:2px;margin-top:1px;margin-bottom:2px" src="https://api.iconify.design/mdi:link-variant.svg" data-v-6caa15cd=""></span><a class="item-show" href="https://en.wikipedia.org/wiki/JSDoc" target="_blank" data-v-6caa15cd="">JsDoc</a>]:<!--[--> 用于注释 js 函数的一个中格式，搭配工具可以生成 html 的文档<!--]--></span></div><div class="list-item" data-v-6caa15cd=""><span data-v-6caa15cd="">[<span data-v-6caa15cd=""><img style="display:inline-block;margin-right:2px;margin-top:1px;margin-bottom:2px" src="https://api.iconify.design/mdi:github.svg" data-v-6caa15cd=""></span><a class="item-show" href="https://github.com/jsdoc/jsdoc" target="_blank" data-v-6caa15cd="">JsDoc 3</a>]:<!--[--> 用于自动生成 js 注释文档的工具<!--]--></span></div><p></p><h3 id="语言规范"><a class="header-anchor" href="#语言规范" aria-hidden="true">#</a>语言规范</h3><p></p><div class="list-item" data-v-6caa15cd=""><span data-v-6caa15cd="">[<span data-v-6caa15cd=""><img style="display:inline-block;margin-right:2px;margin-top:1px;margin-bottom:2px" src="https://api.iconify.design/mdi:link-variant.svg" data-v-6caa15cd=""></span><a class="item-show" href="https://kangax.github.io/compat-table/es6/" target="_blank" data-v-6caa15cd="">ES6</a>]:<!--[--> 查看语言特性的当前支持状态<!--]--></span></div><p></p><h3 id="object"><a class="header-anchor" href="#object" aria-hidden="true">#</a>Object</h3><ul><li>多单词的 key 需要使用引号包裹</li></ul><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    b<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string">"hello world"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span><span class="token string">'hello world'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
key<span class="token operator">=</span><span class="token string">'hello world'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre><ul><li>当数字 0 被用作对象的属性的键时，会被转换为字符串 “0”</li><li>整数属性会被排序，其他的属性会按照创建的顺序排序</li></ul><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> codes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">"49"</span><span class="token operator">:</span> <span class="token string">"Germany"</span><span class="token punctuation">,</span>
  <span class="token string">"41"</span><span class="token operator">:</span> <span class="token string">"Switzerland"</span><span class="token punctuation">,</span>
  <span class="token string">"44"</span><span class="token operator">:</span> <span class="token string">"Great Britain"</span><span class="token punctuation">,</span>
  <span class="token comment">// ..,</span>
  <span class="token string">"1"</span><span class="token operator">:</span> <span class="token string">"USA"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> code <span class="token keyword">in</span> codes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1, 41, 44, 49</span>
<span class="token punctuation">}</span>
</code></pre><ul><li><p>使用 const 声明的对象也是可以被修改的</p></li><li><p>Object.assign 来做所谓的“浅拷贝”, 因为嵌套的对象同样存在引用</p></li></ul><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token keyword">const</span> abc <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'a'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">'d'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&gt;</span> abc
<span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token punctuation">{</span> d<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> abcd <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> abc</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token punctuation">{</span> d<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> abcd<span class="token punctuation">.</span>c<span class="token punctuation">.</span>d<span class="token operator">=</span><span class="token number">4</span>
<span class="token number">4</span>
<span class="token operator">&gt;</span> abc
<span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token punctuation">{</span> d<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span>
</code></pre><h3 id="构造函数"><a class="header-anchor" href="#构造函数" aria-hidden="true">#</a>构造函数</h3><p>常规来说，它们也是普通的函数，不过有如下的规定：</p><ul><li>它们的命名以大写字母开头。</li><li>它们只能由 “new” 操作符来执行。</li></ul><p>JS 中形如<code>Date</code>或者<code>Set</code>等等的构造函数，都需要使用<code>new</code>操作符来创建。 通常，构造器没有 return 语句。它们的任务是将所有必要的东西写入 this，并自动转换为结果。但是，如果这有一个 return 语句，那么规则就简单了：</p><pre class="language-bash"><code class="language-bash">+ 如果 <span class="token builtin class-name">return</span> 返回的是一个对象，则返回这个对象，而不是 this。
+ 如果 <span class="token builtin class-name">return</span> 返回的是一个原始类型，则忽略。
</code></pre><p>一个例子：</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">"newname"</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'John'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token comment">// { newname: 'John' }</span>

<span class="token comment">// normal variable</span>
<span class="token keyword">function</span> <span class="token function">Person2</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">let</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person2</span><span class="token punctuation">(</span><span class="token string">'John'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span> <span class="token comment">// { name: 'John' }</span>
</code></pre><h3 id="可选链"><a class="header-anchor" href="#可选链" aria-hidden="true">#</a>可选链</h3><p><code>?.</code>这个一般用在判断一个 object 的属性是否存在，如果存在，则返回这个属性的值，否则返回 undefined。 所谓的存在一般指的是这个属性是<code>非 null/undefined</code>的。</p><pre class="language-js"><code class="language-js">ret <span class="token operator">=</span> a<span class="token operator">?.</span>b<span class="token operator">?.</span>c<span class="token operator">?.</span>d
</code></pre><p>这可以省去大部分的重复判断代码。除此之外还有<code>?.()</code>和<code>?.[]</code>这两个变体。 这些是可以用于删除和读取的，但是不能用于写入。</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> userAdmin <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"I am admin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> userGuest <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
userAdmin<span class="token punctuation">.</span>admin<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// I am admin</span>
userGuest<span class="token punctuation">.</span>admin<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 啥都没有（没有这样的方法）</span>

<span class="token comment">// 可选 key</span>

<span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">null</span>

user<span class="token operator">?.</span><span class="token punctuation">[</span><span class="token string">'helloworld'</span><span class="token punctuation">]</span> <span class="token comment">// undefined</span>
<span class="token keyword">delete</span> user<span class="token operator">?.</span>key <span class="token comment">// 此处不存在key，所以不会删除，但不会报错</span>

</code></pre><p>注意以上再不存在时均返回<code>undefined</code>。</p><h3 id="symbol"><a class="header-anchor" href="#symbol" aria-hidden="true">#</a>Symbol</h3><p><code>Symbol</code>表示唯一的标识符。可以用于在 object 中，作为 object 的属性名，但是它不会被转换成字符串，是属于独立的类型。 如果想要获取他的定义或者是值，使用如下：</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// Symbol(id)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">.</span>description<span class="token punctuation">)</span> <span class="token comment">// id</span>
</code></pre><p>symbol 的隐藏属性可以让我们安全的在第三方的结构里面增加新的key。 比如：</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> id <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">"John"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

user<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">123</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>usr<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 123</span>
</code></pre><ul><li>在<code>for...in</code>循环中，Symbol 属性会被忽略。</li><li>在<code>Object.keys()</code>中，Symbol 属性会被忽略。</li><li>在<code>Object.assing()</code>中，Symbol 属性会被复制。</li></ul><h4 id="全局-symbol"><a class="header-anchor" href="#全局-symbol" aria-hidden="true">#</a>全局 symbol</h4><ul><li>使用<code>Symbol.for("xxx")</code>来获取全局 symbol。 如果不存在就创建一个新的。存在的就直接返回。</li><li>使用<code>Symbol.keyFor("xxx")</code>来获取 symbol 的名字</li></ul><blockquote><p>从技术上说，Symbol 不是 100% 隐藏的。有一个内建方法 Object.getOwnPropertySymbols(obj) 允许我们获取所有的 Symbol。还有一个名为 Reflect.ownKeys(obj) 的方法可以返回一个对象的 所有 键，包括 Symbol。所以它们并不是真正的隐藏。但是大多数库、内建方法和语法结构都没有使用这些方法。</p></blockquote><h3 id="primitive"><a class="header-anchor" href="#primitive" aria-hidden="true">#</a>primitive</h3><p>可以使用<code>Symbol.primitive</code>的内建 symbol 用来转换方法命名，这个类似于将 object 变成可以处理不同场景下的情况。</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"John"</span><span class="token punctuation">,</span>
  money<span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>

  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token parameter">hint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">hint: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hint<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> hint <span class="token operator">==</span> <span class="token string">"string"</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{name: "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"}</span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>money<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">alert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hint: string -&gt; {name: "John"}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">+</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hint: number -&gt; 1000</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hint: default -&gt; 1500</span>
</code></pre><p>默认情况下，普通对象具有 toString 和 valueOf 方法：</p><ul><li>toString 方法返回一个字符串 “[object Object]”。</li><li>valueOf 方法返回对象自身。</li></ul><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span> <span class="token string">"john"</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// {name: "john"}</span>
</code></pre><p>此时我们可以重写<code>toString</code>和<code>valueOf</code>方法</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"john"</span><span class="token punctuation">,</span>
  value<span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{name: "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">"}</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">alert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>  <span class="token comment">// {name: "John"}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">)</span> <span class="token comment">// 1000</span>

</code></pre><h3 id="数字类型"><a class="header-anchor" href="#数字类型" aria-hidden="true">#</a>数字类型</h3><p><code>toString(base)</code>返回当前数字以 base 形式的字符串。</p><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token number">100</span>
<span class="token number">100</span>
<span class="token operator">&gt;</span> number<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token string">'1100100'</span>
<span class="token operator">&gt;</span> number<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token string">'64'</span>
<span class="token operator">&gt;</span>
</code></pre><p>同样的当我们将字符串的数字变成数字时，<code>parseInt</code>和<code>parseFloat</code>可以帮助我们。不过这<code>parseInt</code>拥有第二个参数，用来制定进制。</p><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token keyword">let</span> anumber <span class="token operator">=</span> <span class="token string">'100'</span>
<span class="token operator">&gt;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>anumber<span class="token punctuation">)</span> <span class="token comment">// 100</span>
<span class="token operator">&gt;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>anumber<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 4, 将 100 看成是二进制的</span>
</code></pre><h3 id="string"><a class="header-anchor" href="#string" aria-hidden="true">#</a>String</h3><p>字符串的<code>indexOf</code>的返回值可以使用一个按位与的小技巧来判断。如下：</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">~</span>str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"o"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"find it"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><p><code>~</code>就是按位取反， 所以<code>~n</code>等价于<code>-(n+1)</code>。 也就是说<code>~-1</code>= 0。 0 在 js 中是表示 falsy 值的。<strong>不过这个技巧不太建议使用</strong>，因为有一定的局限性，且我们可以使用<code>includes</code>来替代。</p><p>一些常用的方法的总结：</p><pre class="language-js"><code class="language-js"><span class="token operator">|</span> 方法 ｜ 选择方式 ｜ 负数参数 <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">|</span> <span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">|</span> <span class="token operator">--</span><span class="token operator">--</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span>	<span class="token operator">|</span> 从 start 到 end（不含 end）<span class="token operator">|</span> 	允许 <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span>	<span class="token operator">|</span> start 与 end 之间（包括 start，但不包括 end）<span class="token operator">|</span> 	负值代表 <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token function">substr</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> length<span class="token punctuation">)</span>	<span class="token operator">|</span> 从 start 开始获取长为 length 的字符串	<span class="token operator">|</span> 允许 start 为负数 <span class="token operator">|</span> 
</code></pre><h3 id="array"><a class="header-anchor" href="#array" aria-hidden="true">#</a>array</h3><p>循环遍历数组可以有如下两种方式：</p><ul><li><code>for (let i=0; i&lt;arr.length; i++)</code>— 运行得最快，可兼容旧版本浏览器。</li><li><code>for (let item of arr)</code>— 现代语法，只能访问 items。</li><li><code>for (let i in arr)</code>— 永远不要用这个。</li></ul><p>数组默认有一个<code>toString</code>的操作。所以我们可以如下操作：</p><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
<span class="token operator">&gt;</span> <span class="token function">String</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token string">'1,2,3,4'</span>
</code></pre><h4 id="splice-start-deletecount-elem1-…-elemn"><a class="header-anchor" href="#splice-start-deletecount-elem1-…-elemn" aria-hidden="true">#</a>splice(start[, deleteCount, elem1, …, elemN])</h4><ul><li>第一个参数表示<code>start</code>的位置；可以是负数，也可以是 0 等等；</li><li>第二个参数表示要删除多少个元素，可以是 0；</li><li>往后的参数表示需要插入的元素，从 start 的位置之后开始。</li></ul><h4 id="concat"><a class="header-anchor" href="#concat" aria-hidden="true">#</a>concat</h4><p>连接多个数组，如果一个 object 是可以被看作数组时，也是可以使用：</p><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
<span class="token operator">&gt;</span> <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token operator">...</span> <span class="token string">"index"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token operator">...</span> <span class="token string">"array"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token operator">...</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token operator">...</span> length<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token number">2</span> empty items<span class="token operator">&gt;</span> <span class="token punctuation">]</span>
<span class="token operator">&gt;</span> <span class="token keyword">let</span> arrayLike <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token operator">...</span>   <span class="token number">0</span><span class="token operator">:</span> <span class="token string">"something"</span><span class="token punctuation">,</span>
<span class="token operator">...</span>   <span class="token number">1</span><span class="token operator">:</span> <span class="token string">"else"</span><span class="token punctuation">,</span>
<span class="token operator">...</span>   <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token operator">...</span>   length<span class="token operator">:</span> <span class="token number">2</span>
<span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&gt;</span> arr<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arrayLike<span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'something'</span><span class="token punctuation">,</span> <span class="token string">'else'</span> <span class="token punctuation">]</span>
</code></pre><h4 id="搜索"><a class="header-anchor" href="#搜索" aria-hidden="true">#</a>搜索</h4><ul><li><code>arr.indexOf(item, from)</code>从索引 from 开始搜索 item，如果找到则返回索引，否则返回 -1。</li><li><code>arr.lastIndexOf(item, from)</code>—— 和上面相同，只是从右向左搜索。</li><li><code>arr.includes(item, from)</code>—— 从索引 from 开始搜索 item，如果找到则返回 true（译注：如果没找到，则返回 false）。</li></ul><h4 id="find-findindex"><a class="header-anchor" href="#find-findindex" aria-hidden="true">#</a>find/findIndex</h4><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> result <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果返回 true，则返回 item 并停止迭代</span>
  <span class="token comment">// 对于假值（falsy）的情况，则返回 undefined</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>数组可以拍平，一般是<code>flat</code>。</p><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr1<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [1, 2, 3, 4]</span>

<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr2<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [1, 2, 3, 4, [5, 6]]</span>

<span class="token keyword">var</span> arr3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr3<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [1, 2, 3, 4, 5, 6]</span>

<span class="token comment">//使用 Infinity，可展开任意深度的嵌套数组</span>
<span class="token keyword">var</span> arr4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr4<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span>
</code></pre><p>具体我们可以参考：</p><p></p><div class="list-item" data-v-6caa15cd=""><span data-v-6caa15cd="">[<span data-v-6caa15cd=""><img style="display:inline-block;margin-right:2px;margin-top:1px;margin-bottom:2px" src="https://api.iconify.design/logos:mozilla.svg" data-v-6caa15cd=""></span><a class="item-show" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/flat" target="_blank" data-v-6caa15cd="">MDN flat documentation</a>]:<!--[--> 包含使用和相关的替代方案<!--]--></span></div><p></p><p>此外还有一个小技巧，<code>Array</code>和<code>Array.of</code>：</p><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token function">Array</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token operator">&lt;</span><span class="token number">7</span> empty items<span class="token operator">&gt;</span> <span class="token punctuation">]</span>
<span class="token operator">&gt;</span> Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token number">7</span> <span class="token punctuation">]</span>
<span class="token operator">&gt;</span> Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token keyword">null</span> <span class="token punctuation">]</span>
<span class="token operator">&gt;</span> Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span> <span class="token keyword">undefined</span> <span class="token punctuation">]</span>
</code></pre><h3 id="迭代"><a class="header-anchor" href="#迭代" aria-hidden="true">#</a>迭代</h3><p>通过 [Symbol.iterator]` 实现 range</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> range <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">from</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  to<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>

  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>from<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>to<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> done<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token operator">++</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> done<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> num <span class="token keyword">of</span> range<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1, 然后是 2, 3, 4, 5</span>
<span class="token punctuation">}</span>
</code></pre><ul><li><code>Iterable</code>如上所述，是实现了 Symbol.iterator 方法的对象。</li><li><code>Array-like</code>是有索引和 length 属性的对象，所以它们看起来很像数组。</li></ul><p>可以使用<code>Array.from</code>对一个 string 类型的变量转换成 array。 比如：</p><pre class="language-js"><code class="language-js"><span class="token operator">&gt;</span> <span class="token keyword">let</span> chars <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> chars
<span class="token punctuation">[</span>
  <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span>
  <span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token string">'o'</span><span class="token punctuation">,</span>
  <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token string">'d'</span>
<span class="token punctuation">]</span>
</code></pre><h3 id="map"><a class="header-anchor" href="#map" aria-hidden="true">#</a>Map</h3><ul><li><code>new Map()</code>—— 创建 map。</li><li><code>map.set(key, value)</code>—— 根据键存储值。</li><li><code>map.get(key)</code>—— 根据键来返回值，如果 map 中不存在对应的 key，则返回 undefined。</li><li><code>map.has(key)</code>—— 如果 key 存在则返回 true，否则返回 false。</li><li><code>map.delete(key)</code>—— 删除指定键的值。</li><li><code>map.clear()</code>—— 清空 map。</li><li><code>map.size</code>—— 返回当前元素个数。</li></ul><blockquote><p>map[key] 不是使用 Map 的正确方式。 应当使用<code>set</code>和<code>get</code></p></blockquote><h4 id="map-迭代"><a class="header-anchor" href="#map-迭代" aria-hidden="true">#</a>map 迭代</h4><p>如果要在 map 里使用循环，可以使用以下三个方法：</p><ul><li><code>map.keys()</code>—— 遍历并返回所有的键（returns an iterable for keys），</li><li><code>map.values()</code>—— 遍历并返回所有的值（returns an iterable for values），</li><li><code>map.entries()</code>—— 遍历并返回所有的实体（returns an iterable for entries）[key, value]，for…of 在默认情况下使用的就是这个。</li></ul><p>此外还有两个比较方便的方法，用于 map 和 object 之间的转换</p><ul><li>Object.fromEntries 将 map 转换成 Object</li><li>Object.entries 生成<code>[[key, value], [key, value]]</code>可以用于创建 map</li></ul><h3 id="set"><a class="header-anchor" href="#set" aria-hidden="true">#</a>Set</h3><ul><li><code>new Set(iterable)</code>—— 创建一个 set，如果提供了一个 iterable 对象（通常是数组），将会从数组里面复制值到 set 中。</li><li><code>set.add(value)</code>—— 添加一个值，返回 set 本身</li><li><code>set.delete(value)</code>—— 删除值，如果 value 在这个方法调用的时候存在则返回 true ，否则返回 false。</li><li><code>set.has(value)</code>—— 如果 value 在 set 中，返回 true，否则返回 false。</li><li><code>set.clear()</code>—— 清空 set。</li><li><code>set.size</code>—— 返回元素个数。</li></ul><h3 id="weakmap-weakset"><a class="header-anchor" href="#weakmap-weakset" aria-hidden="true">#</a>WeakMap / WeakSet</h3><p><code>WeakMap</code>的键只能是<code>object</code>。 当在 object 被清理时，对应的 weakmap 中的内容也会被清理。 weakmap 适合在：</p><ul><li>需要有缓存，当一个函数的结果需要被记住（“缓存”），这样在后续的对同一个对象的调用时，就可以重用这个被缓存的结果。当对象被垃圾回收时，对应的缓存的结果也会被自动地从内存中清除。</li><li>额外的数据，将这些数据放到 WeakMap 中，并使用该对象作为这些数据的键，那么当该对象被垃圾回收机制回收后，这些数据也会被自动清除</li></ul><p>注意， weakmap 只支持如下的几个方法：</p><ul><li>weakMap.get(key)</li><li>weakMap.set(key, value)</li><li>weakMap.delete(key)</li><li>weakMap.has(key)</li></ul><blockquote><p>这两个数据结构均不支持迭代。所以需要在合适的时机使用它们。</p></blockquote><h3 id="object-keys-values-entries"><a class="header-anchor" href="#object-keys-values-entries" aria-hidden="true">#</a>Object.keys, values, entries</h3><blockquote><p>Object.keys/values/entries 会忽略 symbol 属性</p></blockquote><pre class="language-js"><code class="language-js">Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>
  <span class="token comment">// 转换为数组，之后使用 map 方法，然后通过 fromEntries 再转回到对象</span>
  Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>prices<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h3 id="数组解构"><a class="header-anchor" href="#数组解构" aria-hidden="true">#</a>数组解构</h3><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Firstname"</span><span class="token punctuation">,</span> <span class="token string">"Lastname"</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>firstname<span class="token punctuation">,</span> lastname<span class="token punctuation">]</span> <span class="token operator">=</span> arr
</code></pre><p>如果不想要某个元素可以使用<code>,</code>来忽略对应位置上的内容</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> <span class="token punctuation">,</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
</code></pre><p>实际上等号右侧可以是任何可迭代的内容，也可以是任何可以赋值的内容。</p><p>任何剩余的内容，可以使用<code>...</code>来接收。比如：</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> <span class="token operator">...</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>
</code></pre><p>数组解构赋值的默认值是<code>undefined</code></p><h3 id="结构解构"><a class="header-anchor" href="#结构解构" aria-hidden="true">#</a>结构解构</h3><p>我们一般使用结构的字段名来直接获取对应的字段的 value。 也可以将对应的字段的值赋值给自定义的变量。</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">'menu'</span><span class="token punctuation">,</span>
  width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  height<span class="token operator">:</span> <span class="token number">200</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span>title<span class="token punctuation">,</span> width<span class="token operator">:</span> w<span class="token punctuation">,</span> height<span class="token operator">:</span> h<span class="token punctuation">}</span> <span class="token operator">=</span> options 
</code></pre><p>对于不一定存在的字段，我们可以使用<code>=</code>设置默认值。这样避免因为字段不存在而报错。</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">'menu'</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span>width <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span> title<span class="token punctuation">}</span> <span class="token operator">=</span> options
<span class="token comment">//同样可以做到重命名</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span>width<span class="token operator">:</span> w <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> height<span class="token operator">:</span> h <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">,</span> title<span class="token punctuation">}</span> <span class="token operator">=</span> options
</code></pre><p>对应剩余的内容一样可以使用<code>...</code>。</p><p>可以使用前套的解构，一个基本的例子：</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  size<span class="token operator">:</span> <span class="token punctuation">{</span>
    width<span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
    height<span class="token operator">:</span> <span class="token number">200</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  items<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'world'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  extra<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token punctuation">{</span> size<span class="token operator">:</span> <span class="token punctuation">{</span>width<span class="token punctuation">,</span> height<span class="token punctuation">}</span><span class="token punctuation">,</span> items<span class="token operator">:</span><span class="token punctuation">[</span>item1<span class="token punctuation">,</span> item2<span class="token punctuation">]</span><span class="token punctuation">,</span> noexist<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">}</span> <span class="token operator">=</span> options
</code></pre><h3 id="智能函数参数"><a class="header-anchor" href="#智能函数参数" aria-hidden="true">#</a>智能函数参数</h3><p>一个函数需要接收很多的参数时候，我们一般通过传递一个结构到函数内，此时可以使用结构或者是嵌套解构的方式进行：</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">showMenu</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title <span class="token operator">=</span> <span class="token string">"Menu"</span><span class="token punctuation">,</span> width<span class="token operator">:</span> w <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> height <span class="token operator">=</span> <span class="token number">200</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>w<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>height<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">showMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Menu 100 200</span>
</code></pre><h3 id="时间"><a class="header-anchor" href="#时间" aria-hidden="true">#</a>时间</h3><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 时间戳,带毫秒</span>
date<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 或者使用 +date 效果一样</span>
<span class="token comment">// 增加 24 小时，单位毫秒</span>
<span class="token keyword">let</span> onedayLater <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">24</span> <span class="token operator">*</span> <span class="token number">3600</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token comment">// 解析时间</span>
<span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2022-01-02'</span><span class="token punctuation">)</span>

<span class="token comment">//可以完全指定时间</span>
<span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">2011</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//1 Jan 2011, 00:00:00</span>
</code></pre><p>一些比较方便的访问日期的组件：</p><ul><li>getFullYear()</li><li>getMonth() // 0-11</li><li>getDate() // 只返回 1-31 之间的数字</li><li>getHours()</li><li>getMinutes()</li><li>getSeconds()</li><li>getMilliseconds()</li><li>getDay() 返回一周中的第几天 0-6， 0表示周日</li></ul><p>同时，我们可以使用一些设置时间的函数对时间进行设置。这些主要是用来配置一些指定的时间</p><ul><li>setFullYear(year, [month], [date])</li><li>setMonth(month, [date])</li><li>setDate(date)</li><li>setHours(hour, [min], [sec], [ms])</li><li>setMinutes(min, [sec], [ms])</li><li>setSeconds(sec, [ms])</li><li>setMilliseconds(ms)</li><li>setTime(milliseconds)（使用自 1970-01-01 00:00:00 UTC+0 以来的毫秒数来设置整个日期）</li></ul><p>两个时间可以直接相减，结果是 ms 的时间差。 一个更快用于计算时间差的方式是：</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token keyword">let</span> end <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> diff <span class="token operator">=</span> end<span class="token operator">-</span>start
</code></pre><p>可以使用<code>Date.parse(str)</code>来解析日期, 字符串的格式应该为：<code>YYYY-MM-DDTHH:mm:ss.sssZ</code>，其中：</p><ul><li>YYYY-MM-DD —— 日期：年-月-日。</li><li>字符 “T” 是一个分隔符。</li><li>HH:mm:ss.sss —— 时间：小时，分钟，秒，毫秒。</li><li>可选字符 ‘Z’ 为 ±hh:mm 格式的时区。单个字符 Z 代表 UTC+0 时区。</li></ul><h3 id="json"><a class="header-anchor" href="#json" aria-hidden="true">#</a>JSON</h3><p>一般我们使用<code>JSON.parse</code>和<code>JSON.stringify</code>这两个方法。 其中<code>JSON.stringify</code>有两个不太常用参数。<code>JSON.stringify(value, replacer, spaces)</code></p><ul><li>replacer</li></ul><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">'Hello'</span><span class="token punctuation">,</span>
  number<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  arr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用数组</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'arr'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">// '{"arr":[1,2,3]}'</span>

<span class="token comment">// 使用函数</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">replacer</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'arr'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>   <span class="token comment">// '{"title":"Hello","number":10}'</span>
</code></pre><ul><li>space 主要是用来进行美化输出的。</li></ul><h4 id="自定义-tojson"><a class="header-anchor" href="#自定义-tojson" aria-hidden="true">#</a>自定义 toJSON</h4><p>像 toString 进行字符串转换，对象也可以提供 toJSON 方法来进行 JSON 转换。如果可用，JSON.stringify 会自动调用它。</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> room <span class="token operator">=</span> <span class="token punctuation">{</span>
  number<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token function">toJSON</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>number<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> meetup <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">"Conference"</span><span class="token punctuation">,</span>
  room
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>room<span class="token punctuation">)</span> <span class="token comment">// 23</span>

<span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>meetup<span class="token punctuation">)</span>
<span class="token comment">/*
  {
    "title":"Conference",
    "room": 23
  }
*/</span>
</code></pre><h4 id="json-parse"><a class="header-anchor" href="#json-parse" aria-hidden="true">#</a>JSON.parse</h4><p>同样的，JSON.parse 是可以接收一个 receiver 参数的，用于解析一些特殊字段，或者是需要自定义处理的内容。比如：</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> schedule <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{
  "meetups": [
    {"title":"Conference","date":"2017-11-30T12:00:00.000Z"},
    {"title":"Birthday","date":"2017-04-18T12:00:00.000Z"}
  ]
}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

schedule <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>schedule<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token string">'date'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><blockquote><p>注意， replacer 的第一次会返回一个 key 是空，value 是自身的结果，这个在操作的时候需要考虑到。</p></blockquote><h3 id="函数-1"><a class="header-anchor" href="#函数-1" aria-hidden="true">#</a>函数</h3><p>我们可以通过<code>functionname.name</code>来获取一个函数的名称。比如：</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">sayYeah</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'yeah'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sayYeah<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">// sayYeah</span>
</code></pre><p>可以通过<code>length</code>来获取到函数的参数，不过 rest 的参数不会被统计。</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b<span class="token punctuation">,</span> <span class="token operator">...</span>c</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>f1<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token comment">// 2</span>
</code></pre><p>可以给函数自定义一些变量，这样可以做到在函数外部也是可以访问到对应的变量的，这个和闭包是有所不同的。</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">function</span> <span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> counter<span class="token punctuation">.</span>count<span class="token operator">++</span>
  <span class="token punctuation">}</span>

  counter<span class="token punctuation">.</span>count<span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">return</span> counter
<span class="token punctuation">}</span>


<span class="token keyword">let</span> counter <span class="token operator">=</span> <span class="token function">makeCounter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// 0</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// 1</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">.</span>count<span class="token punctuation">)</span> <span class="token comment">// 2</span>
</code></pre><p>函数的 NFE(Named Function Expression), 可以在函数被赋值了另外的一变量的时候仍然可以调用。</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> <span class="token function-variable function">sayhi</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token string">"default"</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> sayhi2 <span class="token operator">=</span> sayhi
<span class="token keyword">let</span> welcome <span class="token operator">=</span> sayhi
<span class="token function">welcome</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
sayhi <span class="token operator">=</span> <span class="token keyword">null</span>

<span class="token function">sayhi2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><h3 id="settimeout-setinterval"><a class="header-anchor" href="#settimeout-setinterval" aria-hidden="true">#</a>setTimeout / setInterval</h3><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> timerId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>func<span class="token operator">|</span>code<span class="token punctuation">,</span> <span class="token punctuation">[</span>delay<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>arg1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>arg2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> timerId <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>func<span class="token operator">|</span>code<span class="token punctuation">,</span> <span class="token punctuation">[</span>delay<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>arg1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>arg2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre><ul><li>setTimeout 允许我们将函数推迟到一段时间间隔之后再执行。</li><li>setInterval 允许我们重复运行一个函数，从一段时间间隔之后开始运行，之后以该时间间隔连续重复运行该函数。</li></ul><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> tid <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"say hello"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">clearTimeout</span><span class="token punctuation">(</span>tid<span class="token punctuation">)</span> <span class="token comment">// 取消推迟执行</span>
</code></pre><blockquote><p>嵌套的 setTimeout 能够精确地设置两次执行之间的延时，而 setInterval 却不能。</p></blockquote><p>这边需要注意的是<code>setInterval</code>是一个固定间隔，如果执行的函数耗时超过这个间隔，setInterval 还是会在指定时间内调用函数。 而用两次嵌套的 setTimeout 可以比较均匀一些。</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">func</span><span class="token punctuation">(</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>注意，例如，浏览器内的计时器可能由于许多原因而变慢：</p><ul><li>CPU 过载。</li><li>浏览器页签处于后台模式。</li><li>笔记本电脑用的是电池供电（译注：使用电池供电会以降低性能为代价提升续航）。</li></ul><p>所有这些因素，可能会将定时器的最小计时器分辨率（最小延迟）增加到 300ms 甚至 1000ms，具体以浏览器及其设置为准。</p><blockquote><p>任何 setTimeout 都只会在当前代码执行完毕之后才会执行。</p></blockquote><h3 id="对象属性配置"><a class="header-anchor" href="#对象属性配置" aria-hidden="true">#</a>对象属性配置</h3><p>可以通过<code>Object.getOwnPropertyDescriptor(obj, propertyName)</code>获取一个对象的指定字段的属性描述信息。 同时可以使用<code>Object.defineProperty(obj, propertyName, descriptor)</code>去设置属性。</p><p>这边一般会涉及到三个标志：</p><ul><li>writable</li><li>enumerable</li><li>configurable</li></ul><p>使用<code>defineProperty</code>可以设置这些标志。 当某个属性的<code>enumerable</code>被设置成 false 时，则该属性将不会出现在<code>for ... in ...</code>中。 当我们将<code>configurable</code>设置成 false 时，则我们无法删除该属性，且该过程不可逆。</p><p>此外我们可以使用<code>defineProerties</code>来设置多个属性的标志。同理可以使用<code>getOwnPropertyDescriptors</code>获取多个属性的。</p><p>可以使用如下方式进行 object 的克隆</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> clone <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptors</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>对象还包含两个访问器属性，<code>getter</code>和<code>setter</code>。即如下的代码：</p><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token function">propName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">propName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>一个 Object 的属性不能既是访问器，有是数据属性，比如下面的方式就是错误的。</p><pre class="language-js"><code class="language-js"><span class="token comment">//error code</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'prop'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>

  value<span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><p>同样访问属性的描述符也可以使用<code>defineProperty</code>来设置。除了<code>value</code>和<code>writable</code>这两个不能设置外，我们可以设置<code>get</code>,<code>set</code>,<code>enumerable</code>和<code>configurable</code>这四个。</p><h2 id="原型"><a class="header-anchor" href="#原型" aria-hidden="true">#</a>原型</h2><p>可以使用<code>__proto__</code>设置，也可以通过<code>getPrototypeOf</code>和<code>setPrototypeOf</code>来代替<code>__proto__</code>的设置方式。</p><p><code>for ... in</code>循环也会迭代继承的属性。但是<code>Object.keys</code>只会返回自己的 key。</p><p>可以使用<code>obj.hasOwnProperty(key)</code>的方式来判断 key 是否是 obj 自身的，而不是痛殴继承获得的。</p><h2 id="f-prototype"><a class="header-anchor" href="#f-prototype" aria-hidden="true">#</a>F.prototype</h2><p>当我们在使用<code>new</code>关键字创建一个新的对象时，同样可以通过继承的方式来获取属性。</p><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Rabbit</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token keyword">let</span> animal <span class="token operator">=</span> <span class="token punctuation">{</span>
  eats<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token class-name">Rabbit</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> animal

<span class="token keyword">let</span> rabbit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rabbit</span><span class="token punctuation">(</span><span class="token string">"White Rabbit"</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rabbit<span class="token punctuation">.</span>eats<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><p>每个函数都有构造器属性，默认的 prototype 只有一个属性<code>constructor</code>的对象，这个属性指向函数本身。</p><p><strong>prototyepe 属性在常规的对象上没有什么特殊的含义，只是一个普通的字段，但是在函数里，就有了特殊意义了</strong></p><h2 id="原生的原型"><a class="header-anchor" href="#原生的原型" aria-hidden="true">#</a>原生的原型</h2><ul><li>所有的内建对象都遵循相同的模式（pattern）：<ul><li>方法都存储在 prototype 中（Array.prototype、Object.prototype、Date.prototype 等）。</li><li>对象本身只存储数据（数组元素、对象属性、日期）。</li></ul></li><li>原始数据类型也将方法存储在包装器对象的 prototype 中：Number.prototype、String.prototype 和 Boolean.prototype。只有 undefined 和 null 没有包装器对象。</li><li>内建原型可以被修改或被用新的方法填充。但是不建议更改它们。唯一允许的情况可能是，当我们添加一个还没有被 JavaScript 引擎支持，但已经被加入 JavaScript 规范的新标准时，才可能允许这样做。</li></ul><blockquote><p>如果要将一个用户生成的键放入一个对象，那么内建的<strong>proto</strong>getter/setter 是不安全的。因为用户可能会输入 “<strong>proto</strong>” 作为键，这会导致一个 error，虽然我们希望这个问题不会造成什么大影响，但通常会造成不可预料的后果。</p></blockquote><blockquote><p>因此，我们可以使用 Object.create(null) 创建一个没有<strong>proto</strong>的 “very plain” 对象，或者对此类场景坚持使用 Map 对象就可以了。</p></blockquote></div><!--]--></div></article></div></div></main><footer max-w="screen-lg" m="ml-4" w="full" p="y-8" text="dark:white dark:opacity-50 sm"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 2025 © Jesse Chan</a></footer></div></div><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("color-schema")||"auto";("dark"===a||e&&"light"!==a)&&document.documentElement.classList.toggle("dark",!0)}()</script></body></html>