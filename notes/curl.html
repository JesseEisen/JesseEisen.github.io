<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="referrer" content="no-referrer"><link rel="icon" href="/favicon.svg" type="image/svg+xml"><link rel="apple-touch-icon" href="/pwa-192x192.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#00aba9"><meta name="msapplication-TileColor" content="#00aba9"><meta name="theme-color" content="#ffffff"><script type="module" async="" crossorigin="" src="/assets/app.449ba84e.js"></script><link rel="modulepreload" href="/assets/vendor.80607e96.js"><link rel="stylesheet" href="/assets/app.288c200a.css"><link rel="manifest" href="/manifest.webmanifest"><link rel="modulepreload" crossorigin="" href="/assets/curl.95298db9.js"><link rel="modulepreload" crossorigin="" href="/assets/ShortHR.090ec3c7.js"><link rel="stylesheet" href="/assets/ShortHR.10dbff62.css"><link rel="modulepreload" crossorigin="" href="/assets/LinkItem.65bc6d8d.js"><link rel="stylesheet" href="/assets/LinkItem.bf447482.css"><meta property="og:title" content="Curl Best Practise"><meta property="og:description" content="collection of curl best pracitse"><meta name="description" content="collection of curl best pracitse"><meta name="head:count" content="3"><title>Chan93</title></head><body><div id="app" data-server-rendered="true"><div h="full" flex="~ col" p="x-4"><nav z="100" text="dark-100 dark:light-900" position="fixed top-0 left-0 right-0" bg="dark:dark-500 dark:opacity-50 white opacity-75" backdrop="~ blur-lg" h="18" p="x-4" border="b-1 dark:dark-500"><div max-w="screen-lg" m="ml-4" h="full" flex="~ row" items="center" space="x-4"><a href="/" class="" flex="1"><h1 text="2xl" font="bold">🐣 WhatIf</h1></a><a href="/blogs" class=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 16c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2M6 16c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m12 12c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2m0-6c1.1 0 2 .9 2 2s-.9 2-2 2s-2-.9-2-2s.9-2 2-2z" fill="currentColor"></path></svg></a><a href="/notes" class=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M14.6 16.6l4.6-4.6l-4.6-4.6L16 6l6 6l-6 6l-1.4-1.4m-5.2 0L4.8 12l4.6-4.6L8 6l-6 6l6 6l1.4-1.4z" fill="currentColor"></path></svg></a><a href="/books" class=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2l4 13l3-1l-4-13l-3 1M5 5v13h3V5H5M3 19v2h18v-2H3z" fill="currentColor"></path></svg></a><a href="/daily" class=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5z" fill="currentColor"></path></svg></a><a href="https://github.com/jesseeisen" target="_blank" rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33c.85 0 1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2z" fill="currentColor"></path></svg></a><a cursor="pointer"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg></a></div></nav><main flex="~ 1 row" justify="start" w="full" max-w="screen-lg" m="ml-4" p="t-18" text="dark:light-400 dark-300"><div data-v-610c0928=""><div data-v-610c0928=""><a flex="~ row" items="center" class="dark:text-white-900 dark:opacity-60" space="x-2" m="t-4" cursor="pointer" data-v-610c0928=""><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32" text="12px" data-v-610c0928=""><path d="M14 26l1.41-1.41L7.83 17H28v-2H7.83l7.58-7.59L14 6L4 16l10 10z" fill="currentColor"></path></svg><span text="12px dark:light-50 true-gray-500" font="bold" data-v-610c0928="">Back to prev</span></a></div><header text="center" border="b-1 dark:dark-200" p="y-10" data-v-610c0928=""><h1 text="36px dark:light-50 dark " font=" extrabold -.015em 48px" class="post-title" data-v-610c0928="">Curl Best Practise</h1><div my="20px" data-v-610c0928=""><span text="sm dark:light-900 dark:opacity-60 #666" m="b-2" display="block" data-v-610c0928="">Jan 23, 2023</span></div><div text="left" flex="~" m="t-4" data-v-610c0928=""><div flex="~ row" items="center" space="x-2" class="mx-auto" data-v-610c0928="" data-v-22abfd34=""><img border="rounded-full" src="https://secure.gravatar.com/avatar/190aa3adff4e1451b32c354f0b5fd7f9?size=30" data-v-22abfd34=""><div flex="~ col" class="author-info" data-v-22abfd34=""><span text="500 dark:light-900 dark:opacity-80 dark-900" data-v-22abfd34="">Linkang Chan</span><br data-v-22abfd34=""><a href="https://twitter.com/JessEisen_LJ" class="text-pink-500 text-sm" target="_blank" data-v-22abfd34="">@Jesse Chan</a></div></div></div></header><div flex="~" w="60%" justify="start" data-v-610c0928=""><article m="t-8" data-v-610c0928=""><div w="90%" class="prose prose-lg" text="dark:light-900 dark:opacity-72" data-v-610c0928=""><!--[--><div><p></p><div class="table-of-contents"><ul><li><a href="#debug-related">Debug Related</a></li><li><a href="#host">HOST</a></li><li><a href="#proxy">Proxy</a></li><li><a href="#username-and-password">Username and password</a></li><li><a href="#fetch-page">Fetch page</a></li><li><a href="#多个-url-同时请求">多个 URL 同时请求</a></li><li><a href="#html-forms">HTML Forms</a><ul><li><a href="#get">GET</a></li><li><a href="#post">POST</a></li><li><a href="#文件上传">文件上传</a></li><li><a href="#location">Location</a></li></ul></li><li><a href="#cookies">Cookies</a></li><li><a href="#https">HTTPS</a></li><li><a href="#自定义">自定义</a></li><li><a href="#一些技巧和选项">一些技巧和选项</a></li></ul></div><p></p><p>本文用来记录一些 Curl 日常使用中的技巧和注意点，虽然现在大部分的调试软件或者工具提供了自动生成的代码的功能，但是在服务器上操作时，可以熟练掌握这些技巧可以快速的提高我们的工作效率。</p><h2 id="debug-related"><a class="header-anchor" href="#debug-related" aria-hidden="true">#</a>Debug Related</h2><ul><li><strong>-v/–trace/–trace-ascii</strong></li></ul><p>可以用来展示请求的 protocol 和具体的请求和回复的内容</p><ul><li><strong>–trace-time</strong></li></ul><p>从名字上便可以发现这个是用于统计请求的时间</p><pre class="language-shell"><code class="language-shell">$ <span class="token function">curl</span> --trace-ascii d.txt --trace-time http://example.com/
</code></pre><div class="outer" data-v-a0e12a16=""><div class="short-hr" data-v-a0e12a16=""></div></div><h2 id="host"><a class="header-anchor" href="#host" aria-hidden="true">#</a>HOST</h2><p>通常我们在使用域名访问的时候，一般是通过 DNS 或者<code>/etc/hosts</code>文件中的定义自动解析的。当我们的域名还没有生效或者暂时未绑定对应服务器的 IP 时，可以通过<code>--resolve</code>选项来指定。</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> --resolve www.example.org:80:127.0.0.1 http://www.example.org/
</code></pre><h2 id="proxy"><a class="header-anchor" href="#proxy" aria-hidden="true">#</a>Proxy</h2><p>可以在域名后面添加端口号，也可以使用通过 proxy 的方式来指定。</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> --proxy http://proxy.example.org:4321 http://remote.example.org
</code></pre><h2 id="username-and-password"><a class="header-anchor" href="#username-and-password" aria-hidden="true">#</a>Username and password</h2><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> -u user:password http://example.org/
</code></pre><h2 id="fetch-page"><a class="header-anchor" href="#fetch-page" aria-hidden="true">#</a>Fetch page</h2><p>正常情况下默认是 GET 的方式访问指定的目标网址，如果我们想看返回的目标地址的头部信息时，可以使用如下两个选项：</p><ul><li><code>-i</code>连同 response 的 body 返回 header 相关的信息</li><li><code>-I</code>只返回 header 相关的信息，方便用于调试</li></ul><h2 id="多个-url-同时请求"><a class="header-anchor" href="#多个-url-同时请求" aria-hidden="true">#</a>多个 URL 同时请求</h2><p>curl 支持对具有相同请求参数的 URL 发起请求。比如：</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">bash</span> http://url1.xxx.com http://url2.xxx.com
</code></pre><p>很多时候我们通常会对同一个 url 按照不同的请求方法去发起请求。比如一般先 POST 请求，后面再进行 GET 请求。 此时我们可以使用<code>--next</code>的方式</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> -d <span class="token assign-left variable">score</span><span class="token operator">=</span><span class="token number">10</span> http://example.com/post.cgi --next http://example.com/results.html
</code></pre><div class="outer" data-v-a0e12a16=""><div class="short-hr" data-v-a0e12a16=""></div></div><h2 id="html-forms"><a class="header-anchor" href="#html-forms" aria-hidden="true">#</a>HTML Forms</h2><blockquote><p>Forms are the general way a website can present an HTML page with fields for the user to enter data in, and then press some kind of ‘OK’ or ‘Submit’ button to get that data sent to the server. The server then typically uses the posted data to decide how to act. Like using the entered words to search in a database, or to add the info in a bug tracking system, display the entered address on a map or using the info as a login-prompt verifying that the user is allowed to see what it is about to see.</p></blockquote><h3 id="get"><a class="header-anchor" href="#get" aria-hidden="true">#</a>GET</h3><p>这个方式比较简单，可以类似于 url 的 query 请求方式。因为 GET 的方式会将所有的参数体现在 URL 中</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> <span class="token string">"http://www.example.com/when/junk/birthday=1905&amp;press=OK"</span>
</code></pre><h3 id="post"><a class="header-anchor" href="#post" aria-hidden="true">#</a>POST</h3><p>使用 post 方法的 form data 请求方式有几个好处：</p><ul><li>避免 URL 过长</li><li>避免一些敏感信息直接在 URL 中暴露</li><li>适用于需要传输较大内容或者无法阅读的 URL</li></ul><p>需要注意的是 curl 请求一般不会对内容进行编码，而 formdata 的方式需要发送的数据一定是经过编码的。如果我们单纯的使用<code>--data</code>来指定 formdata 参数时需要注意一些特殊符号的编码，比如空格需要改成<code>%20</code>。</p><blockquote><p>一般这种类型的 POST 请求的 Content-Type 需要指定为 application/x-www-form-urlencoded</p></blockquote><p>在较新的 curl 版本中，可以通过<code>--data-urlencode</code>的方式让 curl 帮助我们将编码完成。 当我们重复使用<code>--data</code>选项时，curl 会自动将其使用<code>&amp;</code>符号将其合并起来。这一点方便在写脚本时的可阅读性。</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> --data-urlencode <span class="token string">"name=I am Jesse"</span> http://www.example.com
</code></pre><h3 id="文件上传"><a class="header-anchor" href="#文件上传" aria-hidden="true">#</a>文件上传</h3><p>当请求需要的是上传文件时，我们一般指定<code>Content-type: multipart/form-data</code>。 不过在使用 curl 请求的时候，我们可以之间的通过如下的方式操作即可，相关的请求头 curl 会帮我们设置。</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> --form <span class="token assign-left variable">upload</span><span class="token operator">=</span>@localfilename --form <span class="token assign-left variable">press</span><span class="token operator">=</span>OK <span class="token punctuation">[</span>URL<span class="token punctuation">]</span>
</code></pre><p>这种方式可以比较方便的将本地文件直接作为 form data 的请求的一部分。</p><p>其实如果请求支持<code>PUT</code>方法的话，此时可以使用<code>--upload-file</code>的方式来上传。</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> --upload-file uploadfile http://www.example.com/upload
</code></pre><h3 id="location"><a class="header-anchor" href="#location" aria-hidden="true">#</a>Location</h3><p>一般 location 选项用于返回值的重定向。所以如果目标 URL 返回的是其他的地址时，可以增加这个选项<code>--location</code>。</p><div class="outer" data-v-a0e12a16=""><div class="short-hr" data-v-a0e12a16=""></div></div><h2 id="cookies"><a class="header-anchor" href="#cookies" aria-hidden="true">#</a>Cookies</h2><p>一般的方式是使用<code>--dump-header</code>存储 cookie，后续使用<code>--cookie xxx_file</code>使用储存的 cookie。</p><p>也可以使用<code>--cookie-jar</code>的方式来更新 cookie 文件.</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> --cookie cookies.txt --cookie-jar newcookies.txt http://example.com
</code></pre><div class="outer" data-v-a0e12a16=""><div class="short-hr" data-v-a0e12a16=""></div></div><h2 id="https"><a class="header-anchor" href="#https" aria-hidden="true">#</a>HTTPS</h2><p>可以使用<code>--cert</code>来指定证书。</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> --cert mycert.pem https://secure.example.com
</code></pre><div class="outer" data-v-a0e12a16=""><div class="short-hr" data-v-a0e12a16=""></div></div><h2 id="自定义"><a class="header-anchor" href="#自定义" aria-hidden="true">#</a>自定义</h2><p>可以使用<code>--headers</code>来自定义一些请求头。<code>--request/-X</code>来指定请求方法。</p><p></p><div class="list-item" data-v-6caa15cd=""><span data-v-6caa15cd="">[<span data-v-6caa15cd=""><img style="display:inline-block;margin-right:2px;margin-top:1px;margin-bottom:2px" src="https://api.iconify.design/mdi:link-variant.svg" data-v-6caa15cd=""></span><a class="item-show" href="https://curl.se/docs/httpscripting.html" target="_blank" data-v-6caa15cd="">curl documentation</a>]:<!--[--> Curl 文档<!--]--></span></div><p></p><div class="outer" data-v-a0e12a16=""><div class="short-hr" data-v-a0e12a16=""></div></div><h2 id="一些技巧和选项"><a class="header-anchor" href="#一些技巧和选项" aria-hidden="true">#</a>一些技巧和选项</h2><p>When using Curl in shell scripts, always pass<code>-fsSL</code>, which:</p><ul><li>Treats non-2xx/3xx responses as errors (-f).</li><li>Disables the progress meter (-sS).</li><li>Handles HTTP redirects (-L).</li></ul></div><!--]--></div></article></div></div></main><footer max-w="screen-lg" m="ml-4" w="full" p="y-8" text="dark:white dark:opacity-50 sm"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0 2025 © Jesse Chan</a></footer></div></div><script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("color-schema")||"auto";("dark"===a||e&&"light"!==a)&&document.documentElement.classList.toggle("dark",!0)}()</script></body></html>